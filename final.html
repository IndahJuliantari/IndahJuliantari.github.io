<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Katalog KelapaCraft</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #f5f1eb 0%, #e8ddd4 100%);
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Animated background elements */
    .bg-decoration {
      position: fixed;
      pointer-events: none;
      z-index: 0;
    }

    .coconut-float {
      font-size: 2rem;
      opacity: 0.1;
      animation: float 15s infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(180deg); }
    }

    .header {
      background: linear-gradient(135deg, #4a3728, #6b4423, #8b5a3c);
      color: white;
      padding: 1.5rem 2rem;
      font-size: 1.8rem;
      font-weight: 700;
      position: sticky;
      top: 0;
      z-index: 1000;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      backdrop-filter: blur(10px);
      text-align: center;
      animation: slideDown 0.8s ease-out;
    }

    @keyframes slideDown {
      from { transform: translateY(-100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .container {
      display: flex;
      flex-direction: row;
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
      gap: 2rem;
      position: relative;
      z-index: 1;
    }

    .sidebar {
      flex: 1;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 2rem;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      height: fit-content;
      position: sticky;
      top: 120px;
      animation: slideInLeft 0.8s ease-out;
    }

    @keyframes slideInLeft {
      from { transform: translateX(-100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .sidebar h3 {
      margin-bottom: 1.5rem;
      color: #4a3728;
      font-size: 1.4rem;
      font-weight: 600;
      text-align: center;
      position: relative;
    }

    .sidebar h3::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, #d2691e, #8b5a3c);
      border-radius: 2px;
    }

    .info-item {
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: rgba(240, 230, 220, 0.3);
      border-radius: 12px;
      border-left: 4px solid #d2691e;
      transition: all 0.3s ease;
    }

    .info-item:hover {
      transform: translateX(5px);
      box-shadow: 0 4px 15px rgba(210, 105, 30, 0.2);
    }

    .label {
      font-weight: 600;
      color: #6b4423;
      margin-bottom: 0.5rem;
      display: block;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .info-value {
      font-size: 1.1rem;
      color: #333;
      font-weight: 500;
    }

    .main-content {
      flex: 3;
      animation: slideInRight 0.8s ease-out;
    }

    @keyframes slideInRight {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    .controls {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }

    .search-section {
      position: relative;
      margin-bottom: 1.5rem;
    }

    .search-bar {
      position: relative;
    }

    .search-bar input {
      width: 100%;
      padding: 15px 50px 15px 20px;
      font-size: 1.1rem;
      border: 2px solid #e0e0e0;
      border-radius: 25px;
      outline: none;
      transition: all 0.3s ease;
      background: rgba(255, 255, 255, 0.8);
    }

    .search-bar input:focus {
      border-color: #d2691e;
      box-shadow: 0 0 20px rgba(210, 105, 30, 0.3);
      transform: scale(1.02);
    }

    .search-icon {
      position: absolute;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: #8b5a3c;
      font-size: 1.2rem;
      pointer-events: none;
    }

    .scan-section {
      display: flex;
      gap: 1rem;
      margin-bottom: 1.5rem;
      align-items: center;
    }

    .scan-btn {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 25px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
    }

    .scan-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
    }

    .qr-input {
      flex: 1;
      padding: 12px 20px;
      border: 2px solid #4CAF50;
      border-radius: 25px;
      outline: none;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .qr-input:focus {
      box-shadow: 0 0 15px rgba(76, 175, 80, 0.3);
    }

    .filter-section {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .filter-btn {
      padding: 10px 20px;
      border: 2px solid #d2691e;
      background: transparent;
      color: #d2691e;
      border-radius: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
    }

    .filter-btn:hover, .filter-btn.active {
      background: #d2691e;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(210, 105, 30, 0.3);
    }

    .sort-select {
      padding: 10px 15px;
      border: 2px solid #d2691e;
      border-radius: 20px;
      background: white;
      color: #6b4423;
      outline: none;
      cursor: pointer;
    }

    .view-toggle {
      display: flex;
      gap: 10px;
      margin-left: auto;
    }

    .view-btn {
      padding: 10px;
      border: 2px solid #d2691e;
      background: transparent;
      color: #d2691e;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .view-btn.active {
      background: #d2691e;
      color: white;
    }

    .product-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      transition: all 0.5s ease;
    }

    .product-list.list-view {
      grid-template-columns: 1fr;
    }

    .product-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
      overflow: hidden;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.2);
      animation: fadeInUp 0.6s ease-out;
    }

    @keyframes fadeInUp {
      from { transform: translateY(30px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }

    .product-card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }

    .product-card.selected {
      border: 3px solid #d2691e;
      box-shadow: 0 0 30px rgba(210, 105, 30, 0.4);
    }

    .product-card.scanned {
      border: 3px solid #4CAF50;
      box-shadow: 0 0 30px rgba(76, 175, 80, 0.4);
      animation: pulse 1s ease-in-out;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .product-image {
      height: 220px;
      background: linear-gradient(135deg, #f0e6dc, #e8ddd4);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4rem;
      position: relative;
      overflow: hidden;
    }

    .product-image::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
      transform: rotate(45deg);
      transition: all 0.6s ease;
      opacity: 0;
    }

    .product-card:hover .product-image::before {
      animation: shine 0.6s ease-in-out;
      opacity: 1;
    }

    @keyframes shine {
      0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
      100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }

    .product-info {
      padding: 1.5rem;
    }

    .product-info h4 {
      margin: 0 0 0.5rem 0;
      font-size: 1.3rem;
      color: #4a3728;
      font-weight: 600;
    }

    .product-info p {
      margin: 0.3rem 0;
      color: #666;
      font-size: 1rem;
      line-height: 1.4;
    }

    .price {
      color: #d2691e;
      font-weight: 700;
      font-size: 1.2rem;
      margin-top: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .price::before {
      content: 'üí∞';
    }

    .product-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: #d2691e;
      color: white;
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .qr-code {
      position: absolute;
      top: 15px;
      left: 15px;
      background: rgba(255, 255, 255, 0.9);
      padding: 5px 10px;
      border-radius: 10px;
      font-size: 0.8rem;
      font-weight: 600;
      color: #4a3728;
    }

    .no-results {
      text-align: center;
      padding: 4rem 2rem;
      color: #8b5a3c;
      font-size: 1.2rem;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 20px;
      backdrop-filter: blur(10px);
    }

    .floating-buttons {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      z-index: 1000;
    }

    .cart-btn, .scan-float-btn {
      background: linear-gradient(135deg, #d2691e, #8b5a3c);
      color: white;
      border: none;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 8px 25px rgba(210, 105, 30, 0.4);
      transition: all 0.3s ease;
    }

    .scan-float-btn {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      box-shadow: 0 8px 25px rgba(76, 175, 80, 0.4);
    }

    .cart-btn:hover, .scan-float-btn:hover {
      transform: scale(1.1);
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 2000;
      backdrop-filter: blur(10px);
    }

    .modal-content {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 2rem;
      border-radius: 20px;
      max-width: 500px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .scanner-modal .modal-content {
      max-width: 400px;
    }

    .scanner-preview {
      width: 100%;
      height: 300px;
      background: #f0f0f0;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 1rem;
      border: 2px dashed #4CAF50;
    }

    .scan-result {
      background: #e8f5e8;
      border: 1px solid #4CAF50;
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
      display: none;
    }

    .scan-result.success {
      display: block;
    }

    .scan-result.error {
      background: #ffeaea;
      border-color: #f44336;
      display: block;
    }

    @media (max-width: 768px) {
      .container {
        flex-direction: column;
        padding: 1rem;
        gap: 1rem;
      }
      
      .sidebar {
        position: static;
      }
      
      .filter-section, .scan-section {
        flex-direction: column;
        align-items: stretch;
      }
      
      .view-toggle {
        margin-left: 0;
        margin-top: 1rem;
      }
      
      .product-list {
        grid-template-columns: 1fr;
      }

      .floating-buttons {
        flex-direction: row;
        right: 15px;
        bottom: 15px;
      }
    }

    .loading {
      display: none;
      text-align: center;
      padding: 2rem;
      color: #8b5a3c;
    }

    .spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid #d2691e;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    .kegunaan {
  color: #444;
  font-size: 0.9rem;
  margin-top: 0.5rem;
  font-style: italic;
}
  </style>
</head>
<body>
  <!-- Background decorations -->
  <div class="bg-decoration coconut-float" style="top: 10%; left: 10%;">ü••</div>
  <div class="bg-decoration coconut-float" style="top: 60%; right: 15%; animation-delay: -5s;">üå¥</div>
  <div class="bg-decoration coconut-float" style="bottom: 20%; left: 5%; animation-delay: -10s;">ü••</div>

  <div class="header">
    ü•• KelapaCraft - Katalog Kerajinan Batok Kelapa Premium
  </div>

  <div class="container">
    <aside class="sidebar">
      <h3>Detail Produk</h3>
      <div class="info-item">
        <span class="label">Fungsi</span>
        <span class="info-value" id="fungsiInfo">Pilih produk untuk melihat detail</span>
      </div>
      <div class="info-item">
        <span class="label">Asal Daerah</span>
        <span class="info-value" id="asalInfo">-</span>
      </div>
      <div class="info-item">
        <span class="label">Finishing</span>
        <span class="info-value" id="finishingInfo">-</span>
      </div>
      <div class="info-item">
        <span class="label">Harga</span>
        <span class="info-value" id="hargaInfo">-</span>
      </div>
      <div class="info-item">
        <span class="label">Rating</span>
        <span class="info-value" id="ratingInfo">-</span>
      </div>
      <div class="info-item">
        <span class="label">Kode QR</span>
        <span class="info-value" id="qrInfo">-</span>
      </div>
      <div class="info-item">
        <span class="label">Deskripsi Singkat</span>
        <span class="info-value" id="kegunaanInfo">-</span>
        </div>
        <div class="info-item">
  <span class="label">Ukuran</span>
  <span class="info-value" id="ukuranInfo">-</span>
</div>
    </aside>

    <main class="main-content">
      <div class="controls">
        <div class="search-section">
          <div class="search-bar">
            <input type="text" placeholder="Cari produk batok kelapa..." oninput="searchProduk(this.value)">
            <div class="search-icon">üîç</div>
          </div>
        </div>

        <div class="scan-section">
          <button class="scan-btn" onclick="openScanner()">
            üì∑ Scan QR Code
          </button>
          <input type="text" class="qr-input" placeholder="Atau masukkan kode QR (contoh: QR001)" oninput="searchByQR(this.value)">
        </div>
        
        <div class="filter-section">
          <button class="filter-btn active" onclick="filterByCategory('semua')">Semua</button>
          <button class="filter-btn" onclick="filterByCategory('peralatan')">Peralatan</button>
          <button class="filter-btn" onclick="filterByCategory('dekorasi')">Dekorasi</button>
          <button class="filter-btn" onclick="filterByCategory('aksesoris')">Aksesoris</button>
          
          <select class="sort-select" onchange="sortProducts(this.value)">
            <option value="nama">Urutkan: Nama</option>
            <option value="harga-rendah">Harga: Rendah ke Tinggi</option>
            <option value="harga-tinggi">Harga: Tinggi ke Rendah</option>
            <option value="rating">Rating Tertinggi</option>
          </select>
          
          <div class="view-toggle">
            <button class="view-btn active" onclick="toggleView('grid')">‚öè</button>
            <button class="view-btn" onclick="toggleView('list')">‚ò∞</button>
          </div>
        </div>
      </div>

      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Memuat produk...</p>
      </div>

      <div class="product-list" id="productList">
        <!-- Produk akan ditampilkan oleh JavaScript -->
      </div>
    </main>
  </div>

  <div class="floating-buttons">
    <button class="scan-float-btn" onclick="openScanner()" title="Scan QR Code">üì∑</button>
    <button class="cart-btn" onclick="showCart()" title="Keranjang">üõí</button>
  </div>

  <!-- Product Modal -->
  <div class="modal" id="productModal">
    <div class="modal-content">
      <h3 id="modalTitle"></h3>
      <div id="modalContent"></div>
      <button onclick="closeModal()" style="margin-top: 1rem; padding: 10px 20px; background: #d2691e; color: white; border: none; border-radius: 10px; cursor: pointer;">Tutup</button>
    </div>
  </div>

  <!-- Scanner Modal -->
  <div class="modal scanner-modal" id="scannerModal">
    <div class="modal-content">
      <h3>üì∑ Scanner QR Code</h3>
      <div class="scanner-preview">
        <div style="text-align: center; color: #666;">
          <div style="font-size: 3rem; margin-bottom: 1rem;">üì∑</div>
          <p>Kamera akan aktif di sini</p>
          <p style="font-size: 0.9rem; margin-top: 0.5rem;">Fitur kamera memerlukan izin browser</p>
        </div>
      </div>
      
      <div class="scan-result" id="scanResult">
        <strong>Produk Ditemukan!</strong>
        <div id="scannedProduct"></div>
      </div>
      
      <div class="scan-result error" id="scanError" style="display: none;">
        <strong>Kode QR tidak ditemukan</strong>
        <p>Pastikan kode QR valid (QR001-QR006)</p>
      </div>
      
      <div style="margin-top: 1rem;">
        <input type="text" placeholder="Atau ketik manual (QR001-QR006)" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; margin-bottom: 1rem;" oninput="manualQRInput(this.value)">
        <div style="display: flex; gap: 10px;">
          <button onclick="startScanning()" style="flex: 1; padding: 10px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer;">Mulai Scan</button>
          <button onclick="closeScannerModal()" style="flex: 1; padding: 10px; background: #666; color: white; border: none; border-radius: 5px; cursor: pointer;">Tutup</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const produk = [
      { 
        nama: "Gelas Batok Kelapa Premium", 
        ukuran: "10x10x8 cm",
        gambar: "gelas.jpeg",
        fungsi: "Peralatan makan ramah lingkungan", 
        asal: "Pupuan, Tabanan", 
        finishing: "Poles halus dengan coating food grade",
        rating: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê",
        kategori: "peralatan",
        badge: "Popular",
        kegunaan: "Gelas alami dari batok kelapa, tahan panas",
        harga: 25000,
        qr: "QR001",
      },
      { 
        nama: "Lampu Hias Batok", 
        ukuran: "20x20x30 cm",
        gambar: "lampu.jpeg",
        fungsi: "Pencahayaan dekoratif tradisional", 
        asal: "Kerambitan, Tabanan", 
        finishing: "Coating glossy dengan ukiran tradisional",
        rating: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê",
        kategori: "dekorasi",
        badge: "Premium",
        kegunaan: "Batok dilubangi artistik, efek cahaya eksotis",
        harga: 150000,
        qr: "QR002"
      },
      { 
        nama: "Tempat Pensil Organik", 
        ukuran: "12x12x15 cm",
        gambar: "kotakpensil.jpeg",
        fungsi: "Organizer alat tulis eco-friendly", 
        asal: "Marga, Tabanan", 
        finishing: "Natural tanpa coating kimia",
        rating: "‚≠ê‚≠ê‚≠ê‚≠ê",
        kategori: "aksesoris",
        badge: "Eco",
        kegunaan: "Ringan dan ramah lingkungan",
        harga: 30000,
        qr: "QR003"
      },
      { 
        nama: "Mangkok Sambal", 
        ukuran: "8x8x4 cm",
        gambar: "mangkok.jpeg",
        fungsi: "Mangkok kecil untuk sambal atau saus", 
        asal: "Penebel, Tabanan", 
        finishing: "Natural finish",
        rating: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê",
        kategori: "peralatan",
        badge: "New",
        kegunaan: "Bentuk mangkuk klasik dari tempurung kelapa",
        harga: 20000,
        qr: "QR004"
      },
      { 
        nama: "Miniatur Rumah", 
        ukuran: "25x20x15cm",
        gambar: "miniatur.jpeg",
        fungsi: "Dekorasi interior dengan sentuhan alam", 
        asal: "Baturiti, Tabanan", 
        finishing: "Poles kilap",
        rating: "‚≠ê‚≠ê‚≠ê‚≠ê",
        kategori: "dekorasi",
        badge: "Trending",
        kegunaan: "Miniatur rumah Bali dari batok kelapa",
        harga: 70000,
        qr: "QR005"
      },
      { 
        nama: "Sendok Hias", 
        ukuran: "20x4cm",
        gambar: "sendok.jpeg",
        fungsi: "Peralatan makan", 
        asal: "Selemadeg, Tabanan", 
        finishing: "Natural finish",
        rating: "‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê",
        kategori: "peralatan",
        badge: "Exclusive",
        kegunaan: "Sendok kecil dengan gagang batok unik",
        harga: 15000,
        qr: "QR006"
      }
    ];

    let currentProducts = [...produk];
    let selectedProductIndex = -1;
    let currentView = 'grid';
    let lastScannedQR = '';

    function showLoading() {
      document.getElementById('loading').style.display = 'block';
      document.getElementById('productList').style.display = 'none';
    }

    function hideLoading() {
      document.getElementById('loading').style.display = 'none';
      document.getElementById('productList').style.display = 'grid';
    }

    function tampilkanProduk(data) {
      showLoading();
      
      setTimeout(() => {
        const list = document.getElementById('productList');
        list.innerHTML = '';
        
        if (data.length === 0) {
          list.innerHTML = '<div class="no-results">üîç Tidak ada produk yang ditemukan</div>';
          hideLoading();
          return;
        }
        
        data.forEach((item, index) => {
          const originalIndex = produk.indexOf(item);
          const card = document.createElement('div');
          const isScanned = item.qr === lastScannedQR;
          card.className = `product-card ${selectedProductIndex === originalIndex ? 'selected' : ''} ${isScanned ? 'scanned' : ''}`;
          card.style.animationDelay = `${index * 0.1}s`;
          
          card.innerHTML = `
            <div class="product-image">
                    <img src="${item.gambar}" alt="${item.nama}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 20px 20px 0 0;">
                    ${item.badge ? `<div class="product-badge">${item.badge}</div>` : ''}
                </div>
                <div class="product-info" onclick="tampilkanDetail(${originalIndex})">
                    <h4>${item.nama}</h4>
                    <p>üìç ${item.asal}</p>
                    <p>‚ú® ${item.finishing}</p>
                    <p>${item.rating}</p>
                    <p class="kegunaan">${item.kegunaan}</p>
                     <p>üìè ${item.ukuran}</p>
                    <div class="price">Rp ${item.harga.toLocaleString('id-ID')}</div>
                </div>
                `;

          card.onclick = () => tampilkanDetail(originalIndex);
          list.appendChild(card);
        });

        hideLoading();
      }, 400);
    }

    function formatHarga(harga) {
      return 'Rp ' + harga.toLocaleString('id-ID');
    }

    function tampilkanDetail(index) {
      selectedProductIndex = index;
      const item = produk[index];

      document.getElementById('fungsiInfo').textContent = item.fungsi;
      document.getElementById('asalInfo').textContent = item.asal;
      document.getElementById('finishingInfo').textContent = item.finishing;
      document.getElementById('hargaInfo').textContent = formatHarga(item.harga);
      document.getElementById('ratingInfo').textContent = item.rating;
      document.getElementById('qrInfo').textContent = item.qr;
      document.getElementById('kegunaanInfo').textContent = item.kegunaan;
      document.getElementById('ukuranInfo').textContent = item.ukuran;


      tampilkanProduk(currentProducts);
    }

    function searchProduk(keyword) {
      const hasil = produk.filter(p => p.nama.toLowerCase().includes(keyword.toLowerCase()));
      currentProducts = hasil;
      tampilkanProduk(hasil);
    }

    function searchByQR(qr) {
      const hasil = produk.find(p => p.qr === qr.trim().toUpperCase());
      if (hasil) {
        lastScannedQR = hasil.qr;
        tampilkanDetail(produk.indexOf(hasil));
        tampilkanProduk([hasil]);
      }
    }

    function filterByCategory(kat) {
      document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');

      if (kat === 'semua') {
        currentProducts = [...produk];
      } else {
        currentProducts = produk.filter(p => p.kategori === kat);
      }
      tampilkanProduk(currentProducts);
    }

    function sortProducts(kunci) {
      const sorted = [...currentProducts];
      if (kunci === 'nama') sorted.sort((a, b) => a.nama.localeCompare(b.nama));
      if (kunci === 'harga-rendah') sorted.sort((a, b) => a.harga - b.harga);
      if (kunci === 'harga-tinggi') sorted.sort((a, b) => b.harga - a.harga);
      if (kunci === 'rating') sorted.sort((a, b) => b.rating.length - a.rating.length);
      tampilkanProduk(sorted);
    }

    function toggleView(mode) {
      currentView = mode;
      const list = document.getElementById('productList');
      document.querySelectorAll('.view-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      list.className = 'product-list' + (mode === 'list' ? ' list-view' : '');
    }

    function openScanner() {
      document.getElementById('scannerModal').style.display = 'block';
    }

    function closeScannerModal() {
      document.getElementById('scannerModal').style.display = 'none';
    }

    function manualQRInput(val) {
      searchByQR(val);
    }

    function showCart() {
      document.getElementById('modalTitle').innerText = 'Keranjang Belanja';
      document.getElementById('modalContent').innerHTML = '<p>Keranjang masih kosong.</p>';
      document.getElementById('productModal').style.display = 'block';
    }

    function closeModal() {
      document.getElementById('productModal').style.display = 'none';
    }

    // Muat awal
    tampilkanProduk(produk);
  </script>
</body>
</html>
